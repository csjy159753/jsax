<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jinhe.modules.sys.dao.SysOrganMapper">

    <select id="selectOrganByOrganId" resultType="com.jinhe.modules.sys.dto.SysOrganDTO">
        SELECT
        so.*,
        count( o.id ) AS childrenNum
        FROM
        sys_organ so
        LEFT JOIN sys_organ o ON o.parent_id = so.id
        AND o.type = #{type}
        WHERE
        so.type = #{type}
        <if test="organId !=null and organId!='' ">
            and so.parent_id=#{organId}
        </if>
        <if test="organId ==null or organId =='' ">
            and so.parent_id  is null
        </if>
        GROUP BY
        so.id
        ORDER BY
        so.region_code
    </select>
</mapper>

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jinhe.modules.sys.dao.SysRegionMapper">

    <select id="listRegionCode" resultType="com.jinhe.modules.sys.dto.SysRegionDTO">
        SELECT
        sr.*
        ,count(r.id) as childrenNum
        FROM
        sys_region sr
        LEFT JOIN sys_region r ON r.parent_code = sr.id
        WHERE
        <if test=" code != null and code !=''">
            sr.`code`=#{code}
        </if>
        <if test=" code == null or code ==''">
            sr.parent_code IS NULL
        </if>
        GROUP BY
        sr.id
        ORDER BY sr.`code`
    </select>
</mapper>

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jinhe.modules.sys.dao.SysUserMapper">

    <select id="listByOrganId" resultType="com.jinhe.modules.sys.dto.SysUserDTO">
            SELECT
        su.*,
        group_concat(
        DISTINCT
        CASE

                WHEN so.id IS NOT NULL THEN
                ( concat( so.id, '_', so.`name` ) ) ELSE ''
            END
            ) AS organIds
        FROM
            sys_user su
            LEFT JOIN sys_user_organ suo ON suo.user_id = su.id
            LEFT JOIN sys_organ so ON so.id = suo.organ_id
    GROUP BY
        su.id
    </select>
</mapper>
